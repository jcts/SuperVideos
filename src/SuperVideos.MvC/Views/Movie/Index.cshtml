@model X.PagedList.IPagedList<SuperVideos.Application.Models.MovieViewModel>
@using X.PagedList.Mvc.Core;
<style>

    .container-slider {
        white-space: nowrap;
        overflow-x: hidden;
    }

    .box {
        display: inline-block;
        vertical-align: top;
    }

    main {
        overflow-x: hidden !important;
    }
</style>

<style>

    /* Tabs Start */

    .ease {
        -webkit-transition: all .5s;
        -moz-transition: all .5s;
        -o-transition: all .5s;
        transition: all .5s;
    }

    .tabs {
        background: #fff;
        position: relative;
        margin-bottom: 50px;
    }

        .tabs > input,
        .tabs > span {
            width: 20%;
            height: 40px;
            line-height: 40px;
            position: absolute;
            top: 0;
        }

        .tabs > input {
            cursor: pointer;
            filter: alpha(opacity=0);
            opacity: 0;
            position: absolute;
            z-index: 99;
        }

        .tabs > span {
            background: #f0f0f0;
            text-align: center;
            overflow: hidden;
        }

            .tabs > span i,
            .tabs > span {
                -webkit-transition: all .5s;
                -moz-transition: all .5s;
                -o-transition: all .5s;
                transition: all .5s;
            }

        .tabs > input:hover + span {
            background: rgba(255,255,255,.1);
        }

        .tabs > input:checked + span {
            background: #fff;
        }

        .tabs > input:checked + span,
        .tabs > input:hover + span {
            color: #58508d;
        }

    #tab-1, #tab-1 + span {
        left: 0;
    }

    #tab-2, #tab-2 + span {
        left: 20%;
    }

    #tab-3, #tab-3 + span {
        left: 40%;
    }

    #tab-4, #tab-4 + span {
        left: 60%;
    }

    #tab-5, #tab-5 + span {
        left: 80%;
    }

    .tab-content {
        padding: 80px 20px 20px;
        width: 100%;
        min-height: 340px;
    }

        .tab-content section {
            width: 100%;
            display: none;
        }

            .tab-content section h1 {
                margin-top: 15px;
                font-size: 100px;
                font-weight: 100;
                text-align: center;
            }

    #tab-1:checked ~ .tab-content #tab-item-1 {
        display: block;
    }

    #tab-2:checked ~ .tab-content #tab-item-2 {
        display: block;
    }

    #tab-3:checked ~ .tab-content #tab-item-3 {
        display: block;
    }

    #tab-4:checked ~ .tab-content #tab-item-4 {
        display: block;
    }

    #tab-5:checked ~ .tab-content #tab-item-5 {
        display: block;
    }

    /* effect-3 */

    .effect-3 .line {
        background: #58508d;
        width: 20%;
        height: 2px;
        position: absolute;
        top: 38px;
    }

    #tab-1:checked ~ .line {
        left: 0;
    }

    #tab-2:checked ~ .line {
        left: 20%;
    }

    #tab-3:checked ~ .line {
        left: 40%;
    }

    #tab-4:checked ~ .line {
        left: 60%;
    }

    #tab-5:checked ~ .line {
        left: 80%;
    }

    .option-table {
        background: rgba(255 255 255 / 25%);
        height: 32px;
        width: 32px;
        border-radius: 16px;
        line-height: 32px;
        box-shadow: 0 0.03rem 0 rgb(88 80 141 / 40%);
        margin: 0 5px;
    }

        .option-table:hover {
            background: rgba(255 255 255 / 75%);
            box-shadow: 0 0.04rem 0 rgb(88 80 141 / 90%);
        }

    table tr {
        line-height: 2 !important;
    }

    .link-clean {
        color: unset;
    }

        .link-clean:hover {
            text-decoration: none;
            color: unset;
        }
</style>

<h4>Filmes Cadastrados</h4>

<div class="container-slider row">

    <div class="innerLiner col-sm-12" style="margin-left: 0px;">
        <div class="box box1 col-sm-12">

            <div class="tabs effect-3">
                <!-- tab-title -->
                <input type="radio" id="tab-1" name="tab-effect-3" checked="checked">
                <span><i class="fas fa-file-video"></i> Filmes</span>

                <input type="radio" id="tab-2" name="tab-effect-3">
                <span><i class="fas fa-file-medical"></i> Adicionar</span>

                <div class="line ease"></div>

                <!-- tab-content -->
                <div class="tab-content">
                    <section id="tab-item-1">
                        <table class="table table-striped table-condensed table-sm" id="tabela-movies" width="100%">
                            <thead>
                                <tr>
                                    <th style="display: none;">Id</th>
                                    <th>Nome</th>
                                    <th>Gênero</th>
                                    <th>Duração</th>
                                    <th>Código</th>
                                    <th width="5%">Opções</th>
                                </tr>
                            </thead>

                            @{
                                foreach (var movie in Model)
                                {
                                    <tr>
                                        <td style="display: none;">@movie.Id</td>
                                        <td>@movie.Title</td>
                                        <td>@movie.Gender</td>
                                        <td>@movie.Duration</td>
                                        <td>@movie.Code</td>
                                        <td></td>
                                    </tr>
                                }
                            }

                        </table>
                    </section>
                    <section id="tab-item-2">
                        <div class="row">

                            <div class="col-sm-2" style="display: grid; border-radius:7px; box-shadow: 0px 0px 0.1rem 0px rgb(84 84 100 / 28%); height:min-content">
                                <img src="~/images/sleeve.png" style="width: 143px; height: 200px;" id="avatar-view" />
                                <a href="#" class="link-clean" style="margin-bottom: 1rem;" id="load-file-register-movie" onclick="SuperVideos.Movie.OpenDialogFile()"> <i class="fas fa-camera"></i> Carregar Imagem</a>
                            </div>
                            <div class="col-sm-9" style="display: grid; border-radius:7px; box-shadow: 0px 0px 0.1rem 0px rgb(84 84 100 / 28%); margin-left: 1rem">
                                <span>Dados Básicos</span>
                                <br />
                                <form id="form-register-movie">

                                    <div class="form-group">
                                        <label for="code">Código Interno</label>
                                        <input type="text" class="form-control form-control-sm" id="code" name="code" placeholder="Informe o código interno do Filme" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="title">Título</label>
                                        <input type="text" class="form-control form-control-sm" id="title" name="title" placeholder="Informe o Título do Filme" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="gender">Genêro</label>
                                        <input type="text" class="form-control form-control-sm" id="gender" name="gender" aria-describedby="gender" placeholder="Informe o Gênero do Filme" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="synopsis">Sinopse</label>
                                        <input type="text" class="form-control form-control-sm" id="synopsis" name="synopsis" placeholder="Informe a Sinopse do Filme" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="barcode">Código de Barras</label>
                                        <input type="number" class="form-control form-control-sm" id="barcode" name="barcode" placeholder="Informe o Código de Barras do Filme" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="duration">Duração</label>
                                        <input type="number" class="form-control form-control-sm" id="duration" name="duration" placeholder="Informe a Duração do Filme em minutos" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="isbn">Isbn</label>
                                        <input type="number" class="form-control form-control-sm" id="isbn" name="isbn" placeholder="Informe o número Isbn do Filme" required>
                                    </div>

                                    <button type="submit" class="btn btn-primary">Cadastrar</button>

                                    <input type="file" style="display: none;" id="picture-movie" name="sleeve" accept="image/*" />
                                </form>
                            </div>
                        </div>

                    </section>
                </div>
            </div>

        </div>

        <div class="box box2 col-sm-12">
            @*This is box2
                <input class="backBtn" type="button" value="Back">*@

            <div class="row" id="tab-new-content">

            </div>

        </div>
    </div>

</div>


@section Scripts {

    <script src="~/lib/superfilmes/supervideos-animation.js"></script>
    <script src="~/lib/superfilmes/supervideos-movie.js"></script>

    <script>

        $(document).ready(function () {

            var tbl = $('#tabela-movies').DataTable({
                "language": {
                    url: '//cdn.datatables.net/plug-ins/1.10.24/i18n/Portuguese-Brasil.json'
                },
                "columnDefs": [
                    {
                        "targets": 5,
                        "render": function (data, type, full, meta) {

                            return '<div class="text-center">' +
                                '<span class="btn-group">' +
                                '<a href="#" class="option-table" data-id="' + full[0] + '" onclick="javascript:SuperVideos.Movie.OnEdit(this);">' +
                                '<i class="fa fa-pencil" ></i></a > ' +
                                '<a href="#" class="option-table" data-id="' + full[0] + '" onclick="javascript:SuperVideos.Movie.OnDelete(this);">' +
                                '<i class="fa fa-trash"></i></a>' +
                                '<a href="#" class="option-table" data-id="' + full[0] + '" onclick="javascript:SuperVideos.Movie.OnDetails(this);">' +
                                '<i class="fa fa-info"></i ></a ></span ></div > ';
                        }
                    },
                ]
            });
        });

        $('#form-register-movie').submit((e) => {

            e.preventDefault();
            e.stopPropagation();

            let dataForm = new FormData(e.target);

             $.ajax({
                url: '@Url.Action("Create", "Movie")',
                method: "POST",
                data: dataForm,
                processData: false,
                contentType: false,
                 uploadProgress: (evt, pos, total, percenteComplete) => {

                     console.log(percenteComplete);

                 },
                success: (r) => {


                    SuperVideos.Animation.Toast("Cadastro Realizado");

                    $('#form-register-movie').trigger("reset");

                },
                error: (err) => {

                    SuperVideos.Animation.Toast("Erro Sistêmico");

                },
                complete: function (jqXHR, status) {
                    console.log(jqXHR);
                    console.log(status);
                }
            });
        });

        $('#picture-movie').on('change', (evt) => {

            let src = URL.createObjectURL(evt.currentTarget.files[0]);

            document.getElementById('avatar-view').src = src;

            console.log(evt);
        });


    </script>
}